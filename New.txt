prod@raspberrypi:~ $ sudo bash /media/prod/USBTOOL/test.sh
========================================================================
ğŸ” DIAGNOSTIC SYSTÃˆME TÃ‰LÃ‰CHARGEMENT ARCHIVES - PHP PUR
========================================================================

ğŸ”§ VÃ‰RIFICATIONS SYSTÃˆME DE BASE
   âœ… PrivilÃ¨ges root confirmÃ©s
   âœ… Nginx actif
   âŒ PHP non installÃ©
/media/prod/USBTOOL/test.sh: line 82: php: command not found
   âŒ Extension PHP zip manquante

ğŸ“ FICHIERS DU SYSTÃˆME DE TÃ‰LÃ‰CHARGEMENT
   âŒ archives-list.php MANQUANT
   âŒ download-archive.php MANQUANT
   âœ… downloadbutton.js prÃ©sent
   âœ… downloadbutton.js configurÃ© pour PHP

ğŸ“‚ DOSSIERS DE TRAÃ‡ABILITÃ‰
   âœ… Dossier traÃ§abilitÃ© prÃ©sent (/home/prod/Documents/traÃ§abilitÃ©)
   âœ… PropriÃ©taire: root:root
   âœ… Dossier Archives prÃ©sent
   âœ… Nombre d'annÃ©es archivÃ©es: 0
   âš ï¸  www-data n'a pas accÃ¨s au groupe prod (Ã  configurer)
   âœ… www-data ajoutÃ© au groupe prod

ğŸŒ TESTS HTTP
   ğŸ” Test HTTP archives-list.php...
   âŒ archives-list.php erreur HTTP 404
   ğŸ” Test HTTP download-archive.php...
   âŒ download-archive.php erreur HTTP 404

ğŸ§ª CRÃ‰ATION DE DONNÃ‰ES DE TEST
   ğŸ“ CrÃ©ation d'archives de test...
   âœ… Fichiers de test crÃ©Ã©s pour S28 2025
   âœ… Fichiers de test crÃ©Ã©s pour S50-S52 2024

ğŸ¯ TESTS AVEC DONNÃ‰ES DE TEST
   ğŸ” Test archives-list.php avec donnÃ©es...
   âŒ archives-list.php erreur avec donnÃ©es

   ğŸ” Test tÃ©lÃ©chargement S28 2025...
   âŒ TÃ©lÃ©chargement S28 2025 erreur HTTP 404

   ğŸ” Test tÃ©lÃ©chargement semaine inexistante...
   âœ… TÃ©lÃ©chargement semaine inexistante retourne 404 (correct)

========================================================================
ğŸ“Š RÃ‰SUMÃ‰ DU DIAGNOSTIC
========================================================================

âŒ PROBLÃˆMES IMPORTANTS DÃ‰TECTÃ‰S

Tests rÃ©ussis: 12/21
Tests Ã©chouÃ©s: 8

Le systÃ¨me nÃ©cessite des corrections avant d'Ãªtre utilisable.

===============================================================
ğŸ”§ COMMANDES UTILES POUR DEBUG
===============================================================

â€¢ Tester archives-list.php:
  curl http://localhost/archives-list.php | jq .

â€¢ Tester tÃ©lÃ©chargement:
  curl -o test.zip 'http://localhost/download-archive.php?year=2025&week=28'

â€¢ VÃ©rifier logs Nginx:
  tail -f /var/log/nginx/maxlink-error.log

â€¢ VÃ©rifier permissions traÃ§abilitÃ©:
  ls -la /home/prod/Documents/traÃ§abilitÃ©/

â€¢ Nettoyer les donnÃ©es de test:
  rm -rf /home/prod/Documents/traÃ§abilitÃ©/Archives/202*

prod@raspberrypi:~ $ 
