prod@raspberrypi:~ $ sudo bash /media/prod/USBTOOL/test.sh
========================================================================
üß™ DIAGNOSTIC SYST√àME PHP ARCHIVES v2.0
========================================================================


üîç 1. V√âRIFICATION DES SERVICES
----------------------------------------
Test statut service php_archives...
   ‚úÖ PASS - Service php_archives actif
   ‚ÑπÔ∏è  Statut: active
Test service Nginx...
   ‚úÖ PASS - Nginx actif
   ‚ÑπÔ∏è  Version: 1.22.1
Test service PHP-FPM...
   ‚úÖ PASS - PHP-FPM actif
   ‚ÑπÔ∏è  √âtat: 
Test PHP CLI...
   ‚úÖ PASS - PHP CLI install√©
   ‚ÑπÔ∏è  Version: 8.2.28
Test socket PHP-FPM...
   ‚úÖ PASS - Socket PHP-FPM pr√©sent
   ‚ÑπÔ∏è  Permissions: srw-rw---- www-data:www-data

üîç 2. V√âRIFICATION DE LA CONFIGURATION
----------------------------------------
Test configuration nginx PHP...
   ‚úÖ PASS - Configuration PHP pr√©sente
   ‚ÑπÔ∏è  Socket: /run/php/php8.2-fpm.sock
Test syntaxe nginx...
   ‚úÖ PASS - Syntaxe nginx valide
Test site nginx activ√©...
   ‚úÖ PASS - Site maxlink-dashboard activ√©

üîç 3. V√âRIFICATION DES FICHIERS
----------------------------------------
Test archives-list.php...
   ‚úÖ PASS - Archives List API pr√©sent
   ‚ÑπÔ∏è  Taille: 2913B, Perms: 775 www-data:www-data
Test download-archive.php...
   ‚úÖ PASS - Download API pr√©sent
   ‚ÑπÔ∏è  Taille: 4370B, Perms: 775 www-data:www-data
Test download-manager.js...
   ‚úÖ PASS - JavaScript Manager pr√©sent
   ‚ÑπÔ∏è  Taille: 5058B, Perms: 775 www-data:www-data
Test r√©pertoire archives...
   ‚úÖ PASS - R√©pertoire archives pr√©sent
   ‚ÑπÔ∏è  Perms: 775 www-data:www-data
Test archives de donn√©es...
   ‚ö†Ô∏è  WARN - R√©pertoire archives vide
   ‚ö†Ô∏è  Aucun fichier CSV

üîç 4. TESTS D'ACC√àS HTTP
----------------------------------------
Test acc√®s HTTP archives-list.php...
   ‚úÖ PASS - Archives List API accessible
   ‚ÑπÔ∏è  HTTP 200
Test acc√®s HTTP download-archive.php...
   ‚úÖ PASS - Download API accessible
   ‚ÑπÔ∏è  HTTP 200
Test acc√®s HTTP download-manager.js...
   ‚úÖ PASS - JavaScript Manager accessible
   ‚ÑπÔ∏è  HTTP 200

üîç 5. TESTS FONCTIONNELS
----------------------------------------
Test r√©ponse JSON archives-list.php...
   ‚úÖ PASS - JSON valide retourn√©
   ‚ÑπÔ∏è  Archives trouv√©es: 0
Test r√©ponse JSON download-archive.php...
   ‚úÖ PASS - JSON valide retourn√©
Test performance archives-list.php...
   ‚úÖ PASS - Performance correcte
   ‚ÑπÔ∏è  12ms

üîç 6. V√âRIFICATION S√âCURIT√â
----------------------------------------
Test permissions fichiers...
   ‚ö†Ô∏è  WARN - Permissions incorrectes archives-list.php
   ‚ö†Ô∏è  775, www-data:www-data
   ‚ö†Ô∏è  WARN - Permissions incorrectes download-archive.php
   ‚ö†Ô∏è  775, www-data:www-data
   ‚ö†Ô∏è  WARN - Permissions incorrectes download-manager.js
   ‚ö†Ô∏è  775, www-data:www-data
Test protection injection SQL...
   ‚ö†Ô∏è  WARN - Protection injection incertaine
   ‚ö†Ô∏è  HTTP 000

üîç 7. V√âRIFICATION DES LOGS
----------------------------------------
Test log installation PHP Archives...
   ‚ÑπÔ∏è  INFO - Log d'installation non trouv√©
   üìù Normal si premi√®re installation
Test erreurs Nginx r√©centes...
   ‚úÖ PASS - Aucune erreur r√©cente
   ‚ÑπÔ∏è  Taille log: 78B
Test acc√®s Nginx r√©cents...
   ‚ÑπÔ∏è  INFO - Requ√™tes PHP r√©centes
   üìù 0 dans les 100 derni√®res

========== R√âSUM√â DU DIAGNOSTIC ==========
Tests effectu√©s: 24
‚úÖ R√©ussis: 19
‚ö†Ô∏è  Avertissements: 5
‚ùå √âchecs: 0

‚úÖ SYST√àME FONCTIONNEL - Score: 79%
Syst√®me op√©rationnel avec quelques avertissements mineurs.

üîó URLs de test:
  ‚Ä¢ Archives: http://localhost/archives-list.php
  ‚Ä¢ Download: http://localhost/download-archive.php?help
  ‚Ä¢ Manager:  http://localhost/download-manager.js

üìÅ Chemins importants:
  ‚Ä¢ Dashboard: /var/www/maxlink-dashboard
  ‚Ä¢ Archives:  /home/prod/Documents/tra√ßabilit√©/Archives
  ‚Ä¢ Logs:     /var/log/maxlink/

üí° Actions recommand√©es:
  ‚Ä¢ V√©rifiez les logs: /var/log/nginx/error.log
  ‚Ä¢ Relancez l'installation: sudo scripts/install/php_archives_install.sh
  ‚Ä¢ Testez manuellement les URLs ci-dessus

prod@raspberrypi:~ $ 
